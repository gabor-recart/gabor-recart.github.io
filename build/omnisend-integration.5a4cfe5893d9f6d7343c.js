/*! For license information please see omnisend-integration.5a4cfe5893d9f6d7343c.js.LICENSE.txt */
"use strict";(self.webpackChunk_ghostmonitor_gm_tracking_js=self.webpackChunk_ghostmonitor_gm_tracking_js||[]).push([["omnisend-integration"],{"./app/main/modules/integrations/omnisend/omnisend.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"init\": () => (/* binding */ init)\n/* harmony export */ });\n/* harmony import */ var _ghostmonitor_gm_frontend_logger__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @ghostmonitor/gm-frontend-logger */ \"./node_modules/@ghostmonitor/gm-frontend-logger/dist/logger.js\");\n/* harmony import */ var _ghostmonitor_gm_frontend_logger__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_ghostmonitor_gm_frontend_logger__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _tracking_api__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../tracking-api */ \"./app/main/tracking-api.ts\");\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils */ \"./app/main/utils.js\");\n\n\n\nconst logger = new (_ghostmonitor_gm_frontend_logger__WEBPACK_IMPORTED_MODULE_0___default())();\nlogger.addLogger(new _ghostmonitor_gm_frontend_logger__WEBPACK_IMPORTED_MODULE_0__.ConsoleLogger({\n  urlParam: '_omnisend'\n}));\nasync function init(_ref) {\n  let {\n    domain,\n    shopperId,\n    datadogLogger\n  } = _ref;\n\n  try {\n    logger.addLogger(datadogLogger);\n\n    if (_utils__WEBPACK_IMPORTED_MODULE_2__.getCookie('omnisendContactID')) {\n      logger.debug('Omnisend tracking cookie is already set');\n      return;\n    }\n\n    if (!shopperId) {\n      logger.debug('No shopper id found');\n      return;\n    }\n\n    const data = await _tracking_api__WEBPACK_IMPORTED_MODULE_1__.getOmnisendContactId(shopperId);\n\n    if (data !== null && data !== void 0 && data.contactId) {\n      _utils__WEBPACK_IMPORTED_MODULE_2__.setCookie({\n        name: 'omnisendContactID',\n        value: data.contactId,\n        expires: 365,\n        domain: domain.startsWith('.') ? domain : \".\".concat(domain)\n      });\n      logger.debug('Contact identified', {\n        contactId: data.contactId\n      });\n      return;\n    }\n\n    logger.debug('No omnisend contact found for shopper');\n  } catch (error) {\n    logger.error('Omnisend tracking error', {\n      error: error.message\n    });\n  }\n}\n\n//# sourceURL=webpack://@ghostmonitor/gm-tracking-js/./app/main/modules/integrations/omnisend/omnisend.ts?")}}]);