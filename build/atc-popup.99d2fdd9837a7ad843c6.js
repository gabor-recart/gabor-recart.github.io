/*! For license information please see atc-popup.99d2fdd9837a7ad843c6.js.LICENSE.txt */
(self.webpackChunk_ghostmonitor_gm_tracking_js=self.webpackChunk_ghostmonitor_gm_tracking_js||[]).push([["atc-popup"],{"./app/main/atc-popup/atc-popup-loader.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"init\": () => (/* binding */ init)\n/* harmony export */ });\n/* harmony import */ var lodash_get__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lodash/get */ \"./node_modules/lodash/get.js\");\n/* harmony import */ var lodash_get__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(lodash_get__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _settings__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../settings */ \"./app/main/settings.ts\");\n/* harmony import */ var _atc_popup__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./atc-popup */ \"./app/main/atc-popup/atc-popup.js\");\n/* harmony import */ var _messenger_atc_popup__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./messenger-atc-popup */ \"./app/main/atc-popup/messenger-atc-popup.js\");\n\n\n\n\n\nasync function init() {\n  const messengerAtcPopup = _settings__WEBPACK_IMPORTED_MODULE_1__.get('messenger_atc_popup')\n  const isMessengerAtcPopupEnabled = lodash_get__WEBPACK_IMPORTED_MODULE_0___default()(messengerAtcPopup, 'isEnabled', false)\n  const isAtcPopupEnabled = _settings__WEBPACK_IMPORTED_MODULE_1__.get('atc_enabled') ?? false\n  const fbSettings = _settings__WEBPACK_IMPORTED_MODULE_1__.get('fb_messenger')\n  const isFacebookConnected = lodash_get__WEBPACK_IMPORTED_MODULE_0___default()(fbSettings, 'config.isEnabled', false)\n\n  if (isMessengerAtcPopupEnabled && isFacebookConnected) {\n    await _messenger_atc_popup__WEBPACK_IMPORTED_MODULE_3__.init()\n  } else if (isAtcPopupEnabled) {\n    _atc_popup__WEBPACK_IMPORTED_MODULE_2__.init()\n  }\n}\n\n\n//# sourceURL=webpack://@ghostmonitor/gm-tracking-js/./app/main/atc-popup/atc-popup-loader.js?")},"./app/main/atc-popup/atc-popup.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"addButtons\": () => (/* binding */ addButtons),\n/* harmony export */   \"addClickListener\": () => (/* binding */ addClickListener),\n/* harmony export */   \"addToCartButtonSelector\": () => (/* binding */ addToCartButtonSelector),\n/* harmony export */   \"addToCartClickHandler\": () => (/* binding */ addToCartClickHandler),\n/* harmony export */   \"closeModal\": () => (/* binding */ closeModal),\n/* harmony export */   \"currentButtonIndex\": () => (/* binding */ currentButtonIndex),\n/* harmony export */   \"init\": () => (/* binding */ init),\n/* harmony export */   \"isPositionPollOn\": () => (/* binding */ isPositionPollOn),\n/* harmony export */   \"listenDomChanges\": () => (/* binding */ listenDomChanges),\n/* harmony export */   \"localStoragePrefix\": () => (/* binding */ localStoragePrefix),\n/* harmony export */   \"modal\": () => (/* binding */ modal),\n/* harmony export */   \"modalTemplate\": () => (/* binding */ modalTemplate),\n/* harmony export */   \"showModal\": () => (/* binding */ showModal)\n/* harmony export */ });\n/* harmony import */ var local_storage_fallback__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! local-storage-fallback */ \"./node_modules/local-storage-fallback/lib/index.js\");\n/* harmony import */ var lodash_template__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! lodash/template */ \"./node_modules/lodash/template.js\");\n/* harmony import */ var lodash_template__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(lodash_template__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var validator_lib_isEmail__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! validator/lib/isEmail */ \"./node_modules/validator/lib/isEmail.js\");\n/* harmony import */ var validator_lib_isEmail__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(validator_lib_isEmail__WEBPACK_IMPORTED_MODULE_8__);\n/* harmony import */ var _html_templates_atc_modal_html__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../html/templates/atc-modal.html */ \"./app/html/templates/atc-modal.html\");\n/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../config */ \"./app/main/config.js\");\n/* harmony import */ var _replacement__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../replacement */ \"./app/main/replacement.js\");\n/* harmony import */ var _settings__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../settings */ \"./app/main/settings.ts\");\n/* harmony import */ var _tracking_api__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../tracking-api */ \"./app/main/tracking-api.ts\");\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../utils */ \"./app/main/utils.ts\");\n\n\n\n\n\n\n\n\n\n\n\nconst templateOptions = {\n  interpolate: /\\{\\{(.+?)\\}\\}/g\n};\nconst defaultLangObj = {\n  h1: 'Enter your email address',\n  text1: 'To add this item to your cart, please enter your email address.',\n  placeholder: 'Email address',\n  cta: 'Add To Cart'\n};\nlet modal = null;\nlet modalTemplate = _html_templates_atc_modal_html__WEBPACK_IMPORTED_MODULE_2__[\"default\"];\nlet addToCartButtonSelector = null;\nlet currentButtonIndex = null;\nlet isPositionPollOn = null;\nconst localStoragePrefix = 'gm-ghostmonitor-modal-form-';\nconst init = function () {\n  var _storage$getItem, _storage$getItem2, _storage$getItem3;\n  isPositionPollOn = _settings__WEBPACK_IMPORTED_MODULE_5__.get('atc_position_poll') || false;\n  const isEmailInStorage = ((_storage$getItem = local_storage_fallback__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getItem(localStoragePrefix + 'email')) === null || _storage$getItem === void 0 ? void 0 : _storage$getItem.replace(/\"/g, '')) || ((_storage$getItem2 = local_storage_fallback__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getItem('gm-email')) === null || _storage$getItem2 === void 0 ? void 0 : _storage$getItem2.replace(/\"/g, ''));\n  const beforeClosed = (_storage$getItem3 = local_storage_fallback__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getItem(localStoragePrefix + 'close')) === null || _storage$getItem3 === void 0 ? void 0 : _storage$getItem3.replace(/\"/g, '');\n  const isObserveDom = typeof _settings__WEBPACK_IMPORTED_MODULE_5__.get('atc_observe_dom') !== 'undefined' ? _settings__WEBPACK_IMPORTED_MODULE_5__.get('atc_observe_dom') : true;\n  if (!isEmailInStorage && !beforeClosed && !(0,_utils__WEBPACK_IMPORTED_MODULE_7__.hasEmail)()) {\n    addButtons();\n    if (isObserveDom) {\n      listenDomChanges();\n    }\n  }\n  let langObj = {};\n  try {\n    const langObjRaw = _settings__WEBPACK_IMPORTED_MODULE_5__.get('atc_translation');\n    const langObjKeys = Object.keys(langObjRaw);\n    langObjKeys.forEach(function (key) {\n      langObj[key] = langObjRaw[key].value;\n    });\n  } catch (e) {\n    langObj = defaultLangObj;\n  }\n  const templateData = langObj;\n  templateData.cssUrl = _settings__WEBPACK_IMPORTED_MODULE_5__.get('ui_css') || _config__WEBPACK_IMPORTED_MODULE_3__[\"default\"].variables.cssUrl;\n  modalTemplate = lodash_template__WEBPACK_IMPORTED_MODULE_1___default()(modalTemplate, templateOptions)(templateData);\n  if (!getAtcVariable('closeable')) {\n    modalTemplate = modalTemplate.replace('<div class=\"ghostmonitor-atc-popup-close\"></div>', '');\n  }\n};\nconst getAtcVariable = function (key) {\n  try {\n    return _settings__WEBPACK_IMPORTED_MODULE_5__.get('atc_variables')[key].value;\n  } catch (e) {\n    console.error(`Error in getAtcVariable. Key: ${key}`, e);\n    return false;\n  }\n};\nconst addButtons = function () {\n  const selectors = Object.assign(_settings__WEBPACK_IMPORTED_MODULE_5__.get('atc_selectors', false), _config__WEBPACK_IMPORTED_MODULE_3__[\"default\"].variables.atcselectors);\n  addToCartButtonSelector = selectors.join(', ');\n  document.querySelectorAll(addToCartButtonSelector).forEach((item, i) => {\n    addClickListener(i, item);\n  });\n};\nconst addClickListener = function (index, item) {\n  const ghostMonitorAddToCart = document.createElement('div');\n  ghostMonitorAddToCart.classList.add((0,_utils__WEBPACK_IMPORTED_MODULE_7__.getAddToCartButtonReplacmentClass)());\n  ghostMonitorAddToCart.setAttribute('data-index', index);\n  window.document.body.append(ghostMonitorAddToCart);\n  _replacement__WEBPACK_IMPORTED_MODULE_4__.addReplace(item, ghostMonitorAddToCart, isPositionPollOn);\n  ghostMonitorAddToCart.addEventListener('click', addToCartClickHandler);\n};\nconst addToCartClickHandler = function (e) {\n  showModal(e);\n};\nconst showModal = function (e) {\n  const d = window.parent.document;\n  const modalEl = d.createElement('div');\n  modalEl.innerHTML = modalTemplate;\n  d.querySelector('body').appendChild(modalEl);\n  _tracking_api__WEBPACK_IMPORTED_MODULE_6__.saveAtcMetric('modal-show');\n  currentButtonIndex = e.target.getAttribute('data-index');\n  modal = modalEl;\n  const form = modal.querySelector('form');\n  if (form) {\n    form.addEventListener('submit', e => {\n      e.preventDefault();\n      const input = modal.querySelector('.ghostmonitor-atc-popup-input');\n      const email = input.value;\n      input.classList.remove('input-error');\n      const popupError = modal.querySelector('.has-error');\n      if (!validator_lib_isEmail__WEBPACK_IMPORTED_MODULE_8___default()(email)) {\n        input.classList.add('input-error');\n        popupError.style.display = '';\n        return;\n      } else {\n        popupError.style.display = 'none';\n      }\n      const submitButton = modal.querySelector(\"button[type='submit']\");\n      submitButton.disabled = true;\n      submitButton.classList.add('ghostmonitor-btn-loading');\n      _tracking_api__WEBPACK_IMPORTED_MODULE_6__.saveAtcMetric('email-provide');\n      (0,_utils__WEBPACK_IMPORTED_MODULE_7__.saveEmailWithForm)({\n        email,\n        formName: 'ghostmonitor-atc-popup'\n      });\n      closeModal();\n      submitButton.removeAttr('disabled');\n      submitButton.classList.remove('ghostmonitor-btn-loading');\n    });\n  }\n  const popupClose = modal.querySelector('.ghostmonitor-atc-popup-close');\n  if (popupClose) {\n    popupClose.addEventListener('click', () => {\n      _tracking_api__WEBPACK_IMPORTED_MODULE_6__.saveAtcMetric('modal-close');\n      closeModal();\n    });\n  }\n};\nconst closeModal = function () {\n  if (!modal) return;\n  modal.parentNode.removeChild(modal);\n  (0,_utils__WEBPACK_IMPORTED_MODULE_7__.removeButtons)();\n  local_storage_fallback__WEBPACK_IMPORTED_MODULE_0__[\"default\"].setItem(localStoragePrefix + 'close', 'true');\n  window.parent.document.querySelectorAll(addToCartButtonSelector)[currentButtonIndex].click();\n};\nconst listenDomChanges = () => {\n  const atcCSSClass = (0,_utils__WEBPACK_IMPORTED_MODULE_7__.getAddToCartButtonReplacmentClass)();\n  observeDOM(window.parent.document.body, mutations => {\n    var _storage$getItem4;\n    let isDomChangesExceptGm = false;\n    if (mutations.type) {\n      isDomChangesExceptGm = false;\n      if (mutations.srcElement && mutations.srcElement.classList && !mutations.srcElement.classList.contains(atcCSSClass)) {\n        isDomChangesExceptGm = true;\n      }\n    } else {\n      mutations.forEach(mutation => {\n        ;\n        [].map.call(mutation.addedNodes, node => {\n          if (node && node.classList && !node.classList.contains(atcCSSClass)) {\n            isDomChangesExceptGm = true;\n          }\n        });\n      });\n    }\n    const atcClosed = (_storage$getItem4 = local_storage_fallback__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getItem(localStoragePrefix + 'close')) === null || _storage$getItem4 === void 0 ? void 0 : _storage$getItem4.replace(/\"/g, '');\n    if (isDomChangesExceptGm && !atcClosed && !(0,_utils__WEBPACK_IMPORTED_MODULE_7__.hasEmail)()) {\n      setTimeout(function () {\n        (0,_utils__WEBPACK_IMPORTED_MODULE_7__.removeButtons)();\n        addButtons();\n      }, 100);\n    }\n  });\n};\nconst observeDOM = function () {\n  const MutationObserver = window.parent.MutationObserver || window.parent.WebKitMutationObserver;\n  const eventListenerSupported = window.parent.addEventListener;\n  return function (obj, callback) {\n    if (MutationObserver) {\n      const obs = new MutationObserver(function (mutations, observer) {\n        if (mutations[0].addedNodes.length || mutations[0].removedNodes.length) {\n          callback(mutations);\n        }\n      });\n      obs.observe(obj, {\n        childList: true,\n        subtree: true\n      });\n    } else if (eventListenerSupported) {\n      obj.addEventListener('DOMNodeInserted', callback, false);\n    }\n  };\n}();\n\n//# sourceURL=webpack://@ghostmonitor/gm-tracking-js/./app/main/atc-popup/atc-popup.js?")},"./app/main/atc-popup/intercept-atc-events/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "addStrongestEventListener": () => (/* binding */ addStrongestEventListener),\n/* harmony export */   "disableATCEventsInterception": () => (/* binding */ disableATCEventsInterception),\n/* harmony export */   "interceptATCEvents": () => (/* binding */ interceptATCEvents),\n/* harmony export */   "runOwnInterceptingScript": () => (/* binding */ runOwnInterceptingScript)\n/* harmony export */ });\n/* harmony import */ var _shopify__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./shopify */ "./app/main/atc-popup/intercept-atc-events/shopify/index.js");\n/* harmony import */ var _woocommerce__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./woocommerce */ "./app/main/atc-popup/intercept-atc-events/woocommerce/index.js");\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils */ "./app/main/utils.ts");\n/* harmony import */ var _logger__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../logger */ "./app/main/logger.ts");\n\n\n\n\nconst debug = message => _logger__WEBPACK_IMPORTED_MODULE_3__["default"].debug(`ðŸ”€ InterceptATCEvents: ${message}`);\nconst matches = (el, selector) => {\n  return (el.matches || el.matchesSelector || el.msMatchesSelector || el.mozMatchesSelector || el.webkitMatchesSelector || el.oMatchesSelector).call(el, selector);\n};\n_utils__WEBPACK_IMPORTED_MODULE_2__._window.ongoingInterception = null;\n_utils__WEBPACK_IMPORTED_MODULE_2__._window.intercepted = false;\nconst interceptors = [];\n\n// eslint-disable-next-line\nfunction addStrongestEventListener() {\n  let eventNamesString = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \'\';\n  let selectors = arguments.length > 1 ? arguments[1] : undefined;\n  let handler = arguments.length > 2 ? arguments[2] : undefined;\n  let options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n  const eventNames = eventNamesString.trim().split(\' \');\n  options = Object.assign({\n    capture: true,\n    // _sdf: strongest dog fucks\n    _sdf: true\n  }, options);\n  eventNames.forEach(eventName => {\n    _utils__WEBPACK_IMPORTED_MODULE_2__._window.document.body.addEventListener(eventName, event => {\n      if (event.target && matches(event.target, selectors)) {\n        return handler(event);\n      }\n    }, options);\n  });\n  _utils__WEBPACK_IMPORTED_MODULE_2__._window.document.querySelectorAll(selectors).forEach(element => {\n    eventNames.forEach(eventName => {\n      element.addEventListener(eventName, handler, options);\n    });\n  });\n}\nfunction interceptATCEvents(_ref) {\n  let {\n    ATCButtonSelector,\n    onATCClick\n  } = _ref;\n  interceptors.push((0,_shopify__WEBPACK_IMPORTED_MODULE_0__["default"])({\n    ATCButtonSelector,\n    onATCClick\n  }));\n  interceptors.push((0,_woocommerce__WEBPACK_IMPORTED_MODULE_1__["default"])({\n    ATCButtonSelector,\n    onATCClick\n  }));\n}\nfunction disableATCEventsInterception() {\n  interceptors.map(interceptor => interceptor.disable());\n}\nasync function runOwnInterceptingScript(handler) {\n  if (_utils__WEBPACK_IMPORTED_MODULE_2__._window.ongoingInterception !== null) {\n    debug("There is an other ongoing interception, let\'s wait for it and don\'t rerun our own handler.");\n    await _utils__WEBPACK_IMPORTED_MODULE_2__._window.ongoingInterception;\n    debug(\'The other interception has finished. Continue the _window.intercepted ATC event.\');\n  } else {\n    debug(\'Run our own ATC clicked event handler\');\n    const interception = Promise.resolve(handler()).then(() => {\n      _utils__WEBPACK_IMPORTED_MODULE_2__._window.ongoingInterception = null;\n      _utils__WEBPACK_IMPORTED_MODULE_2__._window.intercepted = true;\n      debug(\'Continue _window.intercepted ATC event\');\n    });\n    _utils__WEBPACK_IMPORTED_MODULE_2__._window.ongoingInterception = interception;\n    return interception;\n  }\n}\nwindow.__recart = window.__recart || {};\nwindow.__recart.interceptATCEvents = interceptATCEvents;\n\n//# sourceURL=webpack://@ghostmonitor/gm-tracking-js/./app/main/atc-popup/intercept-atc-events/index.js?')},"./app/main/atc-popup/intercept-atc-events/shopify/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ ShopifyATCInterceptor)\n/* harmony export */ });\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../utils */ \"./app/main/utils.ts\");\n/* harmony import */ var _index__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../index */ \"./app/main/atc-popup/intercept-atc-events/index.js\");\n/* harmony import */ var _logger__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../logger */ \"./app/main/logger.ts\");\n\n\n\nconst debug = message => _logger__WEBPACK_IMPORTED_MODULE_2__[\"default\"].debug(`ðŸ”€ ShopifyATCInterceptor: ${message}`);\nfunction ShopifyATCInterceptor(_ref) {\n  let {\n    ATCButtonSelector,\n    onATCClick\n  } = _ref;\n  function interceptClickBasedATC() {\n    debug('Setting up click based ATC interception...');\n    (0,_index__WEBPACK_IMPORTED_MODULE_1__.addStrongestEventListener)('click touchstart', ATCButtonSelector, interceptClick);\n    function interceptClick(event) {\n      if (_utils__WEBPACK_IMPORTED_MODULE_0__._window.intercepted === true) {\n        return true;\n      }\n      debug('Intercepting click based ATC event...');\n      if (event.target.disabled || event.target.parentElement.disabled) {\n        debug('Stopping interceptor because event target is disabled');\n        return;\n      }\n      event.preventDefault();\n      event.stopImmediatePropagation();\n      (0,_index__WEBPACK_IMPORTED_MODULE_1__.runOwnInterceptingScript)(onATCClick).then(() => {\n        if (event.target) {\n          event.target.click();\n        }\n      });\n    }\n  }\n  function interceptFormBasedATC() {\n    debug('Setting up form based ATC interception...');\n    const forms = _utils__WEBPACK_IMPORTED_MODULE_0__._window.document.querySelectorAll('form[action=\"/cart/add\"]');\n    if (forms.length === 0) {\n      return false;\n    }\n    (0,_index__WEBPACK_IMPORTED_MODULE_1__.addStrongestEventListener)('submit', 'form[action=\"/cart/add\"]', onSubmit, {\n      once: true\n    });\n    function onSubmit(event) {\n      if (_utils__WEBPACK_IMPORTED_MODULE_0__._window.intercepted === true) {\n        return true;\n      }\n      debug('Intercepting form based ATC event...');\n      event.preventDefault();\n      event.stopImmediatePropagation();\n      (0,_index__WEBPACK_IMPORTED_MODULE_1__.runOwnInterceptingScript)(onATCClick).then(() => {\n        if (event.target) {\n          event.target.submit();\n        }\n      });\n    }\n  }\n  function interceptAjaxBasedATC() {\n    debug('Setting up native window.XMLHttpRequest based ATC interception...');\n    const send = window.XMLHttpRequest.prototype.send;\n    const interceptUrlMatchers = ['/cart/add.js', 'http[s]*://api.flow.io/shopify/carts/[^/]+/add'];\n    function shouldIntercept(url) {\n      return interceptUrlMatchers.map(matcherRegx => new RegExp(matcherRegx).test(url)).some(v => v);\n    }\n    window.XMLHttpRequest.prototype.send = function (data) {\n      const url = [this.url, this._url].find(x => x);\n      if (_utils__WEBPACK_IMPORTED_MODULE_0__._window.intercepted || !shouldIntercept(url)) {\n        send.call(this, data);\n      } else {\n        debug('Intercepting native window.XMLHttpRequest based ATC event...');\n        (0,_index__WEBPACK_IMPORTED_MODULE_1__.runOwnInterceptingScript)(onATCClick).then(() => {\n          send.call(this, data);\n        });\n      }\n    };\n  }\n  function isShopifyPlatform() {\n    return typeof _utils__WEBPACK_IMPORTED_MODULE_0__._window.Shopify !== 'undefined';\n  }\n  function disable() {\n    onATCClick = () => {\n      debug('Interception disabled.');\n    };\n  }\n  if (!isShopifyPlatform()) {\n    debug('Not Shopify');\n  } else {\n    debug('Shopify platform');\n    interceptClickBasedATC();\n    interceptFormBasedATC();\n    interceptAjaxBasedATC();\n  }\n  return {\n    disable\n  };\n}\n\n//# sourceURL=webpack://@ghostmonitor/gm-tracking-js/./app/main/atc-popup/intercept-atc-events/shopify/index.js?")},"./app/main/atc-popup/intercept-atc-events/woocommerce/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ WooCommerceATCInterceptor)\n/* harmony export */ });\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../utils */ \"./app/main/utils.ts\");\n/* harmony import */ var _logger__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../logger */ \"./app/main/logger.ts\");\n/* harmony import */ var _index__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../index */ \"./app/main/atc-popup/intercept-atc-events/index.js\");\n\n\n\nconst debug = message => _logger__WEBPACK_IMPORTED_MODULE_1__[\"default\"].debug(`ðŸ”€ WooCommerceATCInterceptor: ${message}`);\nfunction WooCommerceATCInterceptor(_ref) {\n  let {\n    ATCButtonSelector,\n    onATCClick\n  } = _ref;\n  function interceptFormBasedATC() {\n    debug('Setting up form based ATC interception...');\n    if (_utils__WEBPACK_IMPORTED_MODULE_0__._window.document.querySelectorAll('.cart').length !== 0) {\n      return false;\n    }\n    (0,_index__WEBPACK_IMPORTED_MODULE_2__.addStrongestEventListener)('submit', '.cart', interceptSubmit);\n    function interceptSubmit(event) {\n      if (_utils__WEBPACK_IMPORTED_MODULE_0__._window.intercepted === true) {\n        return true;\n      }\n      debug('Intercepting form based ATC event...');\n      event.preventDefault();\n      event.stopImmediatePropagation();\n      (0,_index__WEBPACK_IMPORTED_MODULE_2__.runOwnInterceptingScript)(onATCClick).then(() => {\n        if (event.target) {\n          event.target.submit();\n        }\n      });\n    }\n  }\n  function interceptClickBasedATC() {\n    debug('Setting up click based ATC interception...');\n    (0,_index__WEBPACK_IMPORTED_MODULE_2__.addStrongestEventListener)('click touchstart', ATCButtonSelector, interceptClick);\n    function interceptClick(event) {\n      if (_utils__WEBPACK_IMPORTED_MODULE_0__._window.intercepted === true) {\n        return true;\n      }\n      debug('Intercepting click based ATC event...');\n      event.preventDefault();\n      event.stopImmediatePropagation();\n      (0,_index__WEBPACK_IMPORTED_MODULE_2__.runOwnInterceptingScript)(onATCClick).then(() => {\n        if (event.target) {\n          event.target.click();\n        }\n      });\n    }\n  }\n  function isWooCommercePlatform() {\n    return typeof _utils__WEBPACK_IMPORTED_MODULE_0__._window.wc_add_to_cart_params !== 'undefined' || typeof _utils__WEBPACK_IMPORTED_MODULE_0__._window.woocommerce_params !== 'undefined' || typeof _utils__WEBPACK_IMPORTED_MODULE_0__._window.wc_cart_fragments_params !== 'undefined';\n  }\n  function disable() {\n    onATCClick = () => {\n      debug('Interception disabled.');\n    };\n  }\n  if (!isWooCommercePlatform()) {\n    debug('Not WooCommerce');\n  } else {\n    debug('WooCommerce platform');\n    interceptFormBasedATC();\n    interceptClickBasedATC();\n  }\n  return {\n    disable\n  };\n}\n\n//# sourceURL=webpack://@ghostmonitor/gm-tracking-js/./app/main/atc-popup/intercept-atc-events/woocommerce/index.js?")},"./app/main/atc-popup/messenger-atc-popup.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"addToCartButtonSelector\": () => (/* binding */ addToCartButtonSelector),\n/* harmony export */   \"currentButtonIndex\": () => (/* binding */ currentButtonIndex),\n/* harmony export */   \"init\": () => (/* binding */ init),\n/* harmony export */   \"localStoragePrefix\": () => (/* binding */ localStoragePrefix),\n/* harmony export */   \"modal\": () => (/* binding */ modal),\n/* harmony export */   \"preloadImages\": () => (/* binding */ preloadImages),\n/* harmony export */   \"preloadStyleSheets\": () => (/* binding */ preloadStyleSheets),\n/* harmony export */   \"showModalTemplate\": () => (/* binding */ showModalTemplate),\n/* harmony export */   \"waitForMessengerWidgetToRender\": () => (/* binding */ waitForMessengerWidgetToRender)\n/* harmony export */ });\n/* harmony import */ var core_js_modules_es_error_cause_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! core-js/modules/es.error.cause.js */ \"./node_modules/core-js/modules/es.error.cause.js\");\n/* harmony import */ var core_js_modules_es_error_cause_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_error_cause_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var local_storage_fallback__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! local-storage-fallback */ \"./node_modules/local-storage-fallback/lib/index.js\");\n/* harmony import */ var lodash_get__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! lodash/get */ \"./node_modules/lodash/get.js\");\n/* harmony import */ var lodash_get__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(lodash_get__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var lodash_memoize__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! lodash/memoize */ \"./node_modules/lodash/memoize.js\");\n/* harmony import */ var lodash_memoize__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(lodash_memoize__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var lodash_template__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! lodash/template */ \"./node_modules/lodash/template.js\");\n/* harmony import */ var lodash_template__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(lodash_template__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var lodash_uniq__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! lodash/uniq */ \"./node_modules/lodash/uniq.js\");\n/* harmony import */ var lodash_uniq__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(lodash_uniq__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var _logger__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../logger */ \"./app/main/logger.ts\");\n/* harmony import */ var _settings__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../settings */ \"./app/main/settings.ts\");\n/* harmony import */ var _tracking_api__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../tracking-api */ \"./app/main/tracking-api.ts\");\n/* harmony import */ var _tue_metric_collector__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../tue-metric-collector */ \"./app/main/tue-metric-collector.js\");\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../utils */ \"./app/main/utils.ts\");\n/* harmony import */ var _intercept_atc_events__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./intercept-atc-events */ \"./app/main/atc-popup/intercept-atc-events/index.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst metricCollector = (0,_tue_metric_collector__WEBPACK_IMPORTED_MODULE_9__.createMetricCollector)({\n  type: 'tue',\n  slug: 'messenger-atc-popup'\n});\nconst debug = message => _logger__WEBPACK_IMPORTED_MODULE_6__[\"default\"].debug(`ðŸ“„ MessengerATCPopup: ${message}`);\nconst templateSettings = {\n  interpolate: /\\{\\{(.+?)\\}\\}/g\n};\nconst defaultLangObj = {\n  title: 'Join the club on Messenger',\n  paragraph: 'Sign up for the best deals and the latest news. Get access to our new products before anyone else and make sure you never miss incredible deals.',\n  dismissText: \"No thanks, I don't like good deals.\",\n  checkboxCtaText: 'Subscribe'\n};\nconst modal = null;\nconst addToCartButtonSelector = null;\nconst currentButtonIndex = null;\nconst localStoragePrefix = 'gm-ghostmonitor-modal-form-';\nconst staticAssetsBaseUrl = 'https://static.ghostmonitor.com';\nlet modalTemplate;\nasync function init() {\n  var _storage$getItem;\n  const modalHasBeenClosedEver = (_storage$getItem = local_storage_fallback__WEBPACK_IMPORTED_MODULE_1__[\"default\"].getItem(localStoragePrefix + 'close')) === null || _storage$getItem === void 0 ? void 0 : _storage$getItem.replace(/\"/g, '');\n  if (!modalHasBeenClosedEver) {\n    let messengerATCPopupTemplate;\n    try {\n      const response = await fetch(`${staticAssetsBaseUrl}/tue/messenger-atc-popup/default/template.html`);\n      messengerATCPopupTemplate = await response.text();\n    } catch (e) {\n      console.log(\"Couldn't get messengerATCPopupTemplateBody html from S3\");\n      throw e;\n    }\n    modalTemplate = messengerATCPopupTemplate;\n    modalTemplate = updateTemplate(modalTemplate);\n    getModalElement(modalTemplate).then(setATCInterception).catch(err => {\n      debug(`Can't load messenger widget, disable ATC interception. ${err}`);\n    });\n  } else {\n    debug('ATC popup already has been closed once. Skip ATC interception.');\n  }\n  preloadResources();\n}\nfunction preloadResources() {\n  const messengerAtcPopup = _settings__WEBPACK_IMPORTED_MODULE_7__.get('messenger_atc_popup');\n  const designSchema = lodash_get__WEBPACK_IMPORTED_MODULE_2___default()(messengerAtcPopup, 'designSchema', {});\n  const imagesToPreload = [];\n  if (designSchema['header-image']) {\n    imagesToPreload.push(designSchema['header-image'].value);\n  }\n  preloadImages(imagesToPreload);\n}\nfunction preloadStyleSheets(styleSheetsToPreload) {\n  styleSheetsToPreload.forEach(styleSheetUrl => {\n    const link = _utils__WEBPACK_IMPORTED_MODULE_10__._window.document.createElement('link');\n    link.rel = 'stylesheet';\n    link.href = styleSheetUrl;\n    // Temporarily set media to something inapplicable to ensure it'll fetch without blocking render\n    link.media = 'only x';\n    _utils__WEBPACK_IMPORTED_MODULE_10__._window.document.getElementsByTagName('head')[0].appendChild(link);\n  });\n}\nfunction preloadImages() {\n  let imagesToPreload = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  let ImageConstructor = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : window.Image;\n  imagesToPreload.forEach(imageUrl => {\n    const img = new ImageConstructor();\n    img.src = imageUrl;\n  });\n}\nfunction setATCInterception() {\n  (0,_intercept_atc_events__WEBPACK_IMPORTED_MODULE_11__.interceptATCEvents)({\n    ATCButtonSelector: getAddToCartButtonSelector(),\n    onATCClick: () => {\n      scrollToTopOnSmallScreen();\n      return showModalTemplate(modalTemplate);\n    }\n  });\n}\nfunction updateTemplate(modalTemplate) {\n  const templateData = getLanguageObject();\n  modalTemplate = lodash_template__WEBPACK_IMPORTED_MODULE_4___default()(modalTemplate, templateSettings)(templateData);\n  const messengerAtcPopup = _settings__WEBPACK_IMPORTED_MODULE_7__.get('messenger_atc_popup');\n  const designSchema = lodash_get__WEBPACK_IMPORTED_MODULE_2___default()(messengerAtcPopup, 'designSchema', {});\n  modalTemplate = updateCssInTemplate(modalTemplate, designSchema);\n  return modalTemplate;\n}\nfunction updateCssInTemplate(originalHtml, designSchema) {\n  let replacedCss = originalHtml;\n  Object.keys(designSchema).forEach(key => {\n    // &quot;@@header-image&quot\n    replacedCss = replacedCss.replace(`\"@@${key}\"`, designSchema[key].value);\n    if (['header-image', 'send-to-messenger-color', 'checkbox-skin'].includes(key)) {\n      replacedCss = replacedCss.replace(`&quot;@@${key}&quot;`, designSchema[key].value);\n    }\n  });\n  return replacedCss;\n}\nconst messengerWidgetTypes = {\n  checkbox: 'checkbox_with_cta',\n  'send-to-messenger': 'send_to_messenger'\n};\nfunction getWidgetType() {\n  const settings = _settings__WEBPACK_IMPORTED_MODULE_7__.get('messenger_atc_popup');\n  const pluginType = lodash_get__WEBPACK_IMPORTED_MODULE_2___default()(settings, 'variables.optinPluginType.value', 'send-to-messenger');\n  return messengerWidgetTypes[pluginType];\n}\nfunction getLanguageObject() {\n  let langObj = {};\n  const settings = _settings__WEBPACK_IMPORTED_MODULE_7__.get('messenger_atc_popup');\n  try {\n    const langObjRaw = settings.textSchema;\n    Object.keys(langObjRaw).forEach(function (key) {\n      langObj[key] = langObjRaw[key].value;\n    });\n  } catch (e) {\n    langObj = defaultLangObj;\n  }\n  const widgetType = getWidgetType();\n  langObj.widgetType = widgetType;\n  langObj.messengerSubscriptionSource = 'messenger_atc_popup';\n  return langObj;\n}\nfunction getPopupSettings(key) {\n  return _settings__WEBPACK_IMPORTED_MODULE_7__.get(`messenger_atc_popup.variables.${key}.value`);\n}\nfunction getAddToCartButtonSelector() {\n  const defaultSelectors = ['form[action=\"/cart/add\"] button[type=\"submit\"]', 'form[action=\"/cart/add\"] button[type=\"submit\"] *', 'form[action=\"/cart/add\"] input[type=\"submit\"]', 'form[action=\"/cart/add\"] input[type=\"submit\"] *', 'form[action=\"/cart/add.js\"] button[type=\"submit\"]', 'form[action=\"/cart/add.js\"] button[type=\"submit\"] *', 'form[action=\"/cart/add.js\"] input[type=\"submit\"]', 'form[action=\"/cart/add.js\"] input[type=\"submit\"] *'];\n  const siteATCSelectors = _settings__WEBPACK_IMPORTED_MODULE_7__.get('atc_selectors', false) || [];\n  const atcSelectors = lodash_uniq__WEBPACK_IMPORTED_MODULE_5___default()(siteATCSelectors.concat(defaultSelectors));\n  return atcSelectors.join(', ');\n}\nconst getModalElement = lodash_memoize__WEBPACK_IMPORTED_MODULE_3___default()(async modalTemplate => {\n  const modalElement = _utils__WEBPACK_IMPORTED_MODULE_10__._window.document.createElement('div');\n  modalElement.style.display = 'none';\n  modalElement.innerHTML = modalTemplate;\n  _utils__WEBPACK_IMPORTED_MODULE_10__._window.document.querySelector('body').appendChild(modalElement);\n  if (getPopupSettings('closeable') !== true) {\n    const popupClose = modalElement.querySelector('.messenger-atc-popup__close');\n    if (popupClose) {\n      popupClose.remove();\n    }\n  }\n  await waitForMessengerWidgetToRender(modalElement);\n  debug('Messenger widget loaded detected.');\n  return modalElement;\n});\nasync function waitForMessengerWidgetToRender(modalElement) {\n  const checkIntervalMillisec = 100;\n  const maxWaitForRenderMillisec = 10 * 1000;\n  let checkedCount = 0;\n  return new Promise((resolve, reject) => {\n    function checkIfMessengerWidgetRendered() {\n      const widgetContainer = modalElement.querySelector('.recart-messenger-widget');\n      if (widgetContainer && widgetContainer.getAttribute('rendered') === 'hidden') {\n        return reject(new Error('Widget forcefully has been hidden.'));\n      }\n      if (checkIntervalMillisec * checkedCount++ > maxWaitForRenderMillisec) {\n        return reject(new Error(`Max wait for render ${maxWaitForRenderMillisec}ms elapsed.`));\n      }\n      // The rendered attribute alone is not enough, because it's given before we receive the rendered event from FB\n      if (widgetContainer && widgetContainer.getAttribute('rendered') === 'rendered' && widgetContainer.classList.contains('_rmp-state--initial') && widgetContainer.classList.contains('_rmp-fb-force')) {\n        resolve();\n      } else {\n        setTimeout(checkIfMessengerWidgetRendered, checkIntervalMillisec);\n      }\n    }\n    checkIfMessengerWidgetRendered();\n  });\n}\nasync function showModalTemplate(modalTemplate) {\n  const modalElement = await getModalElement(modalTemplate);\n  modalElement.style.display = 'block';\n  metricCollector.send('IMPRESSION');\n  metricCollector.send('ENGAGEMENT');\n  await waitForModalClose(modalElement);\n}\nconst scrollToTopOnSmallScreen = () => {\n  const width = _utils__WEBPACK_IMPORTED_MODULE_10__._window.innerWidth || _utils__WEBPACK_IMPORTED_MODULE_10__._window.document.documentElement.clientWidth || _utils__WEBPACK_IMPORTED_MODULE_10__._window.document.body.clientWidth;\n  if (width <= 768) {\n    _utils__WEBPACK_IMPORTED_MODULE_10__._window.scrollTo(0, 0);\n  }\n};\nfunction waitForModalClose(modalElement) {\n  let isSubscribed = false;\n  const modalCloseButtons = modalElement.querySelectorAll('.ghostmonitor-atc-popup-close');\n  return new Promise(resolve => {\n    if (modalCloseButtons.length > 0) {\n      modalCloseButtons.forEach(button => button.addEventListener('click', resolve));\n    }\n    if (_utils__WEBPACK_IMPORTED_MODULE_10__._window._rmp) {\n      _utils__WEBPACK_IMPORTED_MODULE_10__._window._rmp.on('state_change', event => {\n        const isWidgetSubscribed = event.state === 'STATE_SUBSCRIBED';\n        const isCheckboxWithCta = lodash_get__WEBPACK_IMPORTED_MODULE_2___default()(event, 'widget.type') === messengerWidgetTypes.checkbox;\n        const isSendToMessenger = lodash_get__WEBPACK_IMPORTED_MODULE_2___default()(event, 'widget.type') === messengerWidgetTypes['send-to-messenger'];\n        if (isWidgetSubscribed && (isCheckboxWithCta || isSendToMessenger)) {\n          isSubscribed = true;\n          resolve();\n        }\n      });\n    }\n  }).then(() => {\n    _tracking_api__WEBPACK_IMPORTED_MODULE_8__.saveAtcMetric('modal-close');\n    if (modalElement) {\n      modalElement.remove();\n    }\n    local_storage_fallback__WEBPACK_IMPORTED_MODULE_1__[\"default\"].setItem(localStoragePrefix + 'close', 'true');\n    if (isSubscribed) {\n      metricCollector.send('OPTIN');\n    } else {\n      metricCollector.send('CLOSE');\n    }\n  });\n}\n\n//# sourceURL=webpack://@ghostmonitor/gm-tracking-js/./app/main/atc-popup/messenger-atc-popup.js?")},"./app/main/replacement.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"addReplace\": () => (/* binding */ addReplace)\n/* harmony export */ });\n/* harmony import */ var observe_element_in_viewport__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! observe-element-in-viewport */ \"./node_modules/observe-element-in-viewport/dist/index.esm.js\");\n\nconst requestAnimFrame = function () {\n  return window.parent.requestAnimationFrame || window.parent.webkitRequestAnimationFrame || window.parent.mozRequestAnimationFrame || function (callback) {\n    setTimeout(callback, 1000 / 60);\n  };\n}();\nconst addReplace = (item, replace, isPositionPollOn) => {\n  const zIndex = getZindex(item);\n  if (isPositionPollOn) {\n    ;\n    (function animloop() {\n      requestAnimFrame(animloop);\n      checkViewport(item, replace, zIndex);\n    })();\n  } else {\n    setPosition(item, replace, zIndex);\n    window.document.addEventListener('resize', () => {\n      setPosition(item, replace, zIndex);\n    });\n  }\n};\nconst checkViewport = async (item, replace, zIndex) => {\n  if (window.navigator.userAgent.toLowerCase().indexOf('electron') > -1) return;\n  setPosition(item, replace, zIndex);\n  if (await (0,observe_element_in_viewport__WEBPACK_IMPORTED_MODULE_0__.isInViewport)(item)) {\n    replace.style.display = 'block';\n  } else {\n    replace.style.display = 'none';\n  }\n};\nconst setPosition = (item, replace, zIndex) => {\n  const itemTopPos = parseInt(item.getBoundingClientRect().top + window.parent.window.scrollY, 10);\n  const style = window.parent.window.getComputedStyle(replace);\n  const itemTop = item.getBoundingClientRect().top + window.pageYOffset;\n  const itemLeft = item.getBoundingClientRect().left + window.pageXOffset;\n  const replaceTop = style.getPropertyValue('top').slice(0, -2); // 5px => 5\n  if (itemTopPos === parseInt(replaceTop, 10) && parseInt(itemLeft, 10) === parseInt(replace.style.left, 10)) {\n    return;\n  }\n  replace.style.position = 'absolute';\n  replace.style.top = `${itemTop}px`;\n  replace.style.left = `${itemLeft}px`;\n  replace.style.width = `${item.offsetWidth}px`;\n  replace.style.height = `${item.offsetHeight}px`;\n  replace.style.cursor = 'pointer';\n  replace.style['z-index'] = zIndex;\n};\nconst getZindex = item => {\n  const w = window.parent.window;\n  let zIndex = w.getComputedStyle(item).getPropertyValue('z-index');\n  let currentNode = item;\n  while (!currentNode.matches('body')) {\n    const currentZindex = w.getComputedStyle(item).getPropertyValue('z-index');\n    if (currentZindex && currentZindex !== 'auto') {\n      zIndex = currentZindex;\n    }\n    currentNode = currentNode.parentNode;\n  }\n  if (zIndex === 'auto' || !zIndex) {\n    zIndex = 0;\n  }\n  return parseInt(zIndex) + 1;\n};\n\n//# sourceURL=webpack://@ghostmonitor/gm-tracking-js/./app/main/replacement.js?")},"./app/main/tue-metric-collector.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "createMetricCollector": () => (/* binding */ createMetricCollector)\n/* harmony export */ });\n/* harmony import */ var _ghostmonitor_tracking_pixel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @ghostmonitor/tracking-pixel */ "./node_modules/@ghostmonitor/tracking-pixel/dist/tracking-pixel.module.js");\n/* harmony import */ var local_storage_fallback__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! local-storage-fallback */ "./node_modules/local-storage-fallback/lib/index.js");\n/* harmony import */ var _logger__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./logger */ "./app/main/logger.ts");\n/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./config */ "./app/main/config.js");\n\n\n\n\n\n/**\n * @param {Object} arg1\n * @param {string} arg1.slug\n * @param {string} arg1.type\n */\nfunction createMetricCollector(_ref) {\n  let {\n    type,\n    slug\n  } = _ref;\n  const metricPrefix = `${type.toUpperCase()}_${slug.toUpperCase()}_`.replace(/-/g, \'_\');\n  const send = function (type) {\n    var _storage$getItem, _storage$getItem2;\n    let once = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n    const metricName = metricPrefix + type;\n    const key = `recart_${_config__WEBPACK_IMPORTED_MODULE_3__["default"].variables.sessionId}_metrics`;\n    if (once && (_storage$getItem = local_storage_fallback__WEBPACK_IMPORTED_MODULE_1__["default"].getItem(key)) !== null && _storage$getItem !== void 0 && _storage$getItem.replace(/"/g, \'\') && (_storage$getItem2 = local_storage_fallback__WEBPACK_IMPORTED_MODULE_1__["default"].getItem(key)) !== null && _storage$getItem2 !== void 0 && _storage$getItem2.replace(/"/g, \'\').includes(metricName)) return;\n    try {\n      (0,_ghostmonitor_tracking_pixel__WEBPACK_IMPORTED_MODULE_0__.pixel)(\'metric\', {\n        metricName,\n        metricValue: 1\n      });\n    } catch (error) {\n      _logger__WEBPACK_IMPORTED_MODULE_2__["default"].error(\'TrackMetricFailed\', {\n        error,\n        metricName\n      });\n    }\n    if (once) {\n      var _storage$getItem3;\n      let trackedMetrics = ((_storage$getItem3 = local_storage_fallback__WEBPACK_IMPORTED_MODULE_1__["default"].getItem(key)) === null || _storage$getItem3 === void 0 ? void 0 : _storage$getItem3.replace(/"/g, \'\')) || \'\';\n      trackedMetrics += `${metricName},`;\n      local_storage_fallback__WEBPACK_IMPORTED_MODULE_1__["default"].setItem(key, trackedMetrics);\n    }\n  };\n  return {\n    send\n  };\n}\n\n//# sourceURL=webpack://@ghostmonitor/gm-tracking-js/./app/main/tue-metric-collector.js?')},"./app/html/templates/atc-modal.html":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n// Module\nvar code = "<html>\\n  <head>\\n    <link rel=\\"stylesheet\\" href=\\"{{cssUrl}}\\">\\n  </head>\\n\\n  <body>\\n    <div class=\\"ghostmonitor-container\\">\\n      <div class=\\"ghostmonitor-atc-popup ghostmonitor-atc-popup-center animated slideInDown\\">\\n        <div class=\\"ghostmonitor-atc-popup-wrapper\\">\\n          <div class=\\"ghostmonitor-atc-popup-content\\">\\n            <div class=\\"ghostmonitor-atc-popup-heading-container\\">\\n              <div class=\\"ghostmonitor-atc-popup-icon-container\\">\\n                <span class=\\"ghostmonitor-atc-popup-icon\\">\\n                  <span class=\\"ghostmonitor-atc-popup-plus-sign\\"></span>\\n                </span>\\n              </div>\\n              <div class=\\"ghostmonitor-atc-popup-text-container\\">\\n                <h2 class=\\"ghostmonitor-atc-popup-heading\\">{{h1}}</h2>\\n                <div class=\\"ghostmonitor-atc-popup-text\\">{{text1}}</div>\\n              </div>\\n            </div>\\n\\n            <div class=\\"ghostmonitor-atc-popup-form\\">\\n              <form action=\\"\\" name=\\"ghostmonitor-atc-popup\\">\\n                <div class=\\"ghostmonitor-atc-popup-input-field-container\\">\\n                  <input class=\\"ghostmonitor-atc-popup-input\\" type=\\"text\\" value=\\"\\" name=\\"email\\" placeholder=\\"{{placeholder}}\\">\\n                  <div class=\\"ghostmonitor-atc-popup-error-container has-error\\" style=\\"display: none\\">\\n                    <div class=\\"ghostmonitor-atc-popup-error\\">\\n                      You have to enter a valid e-mail address!\\n                    </div>\\n                  </div>\\n                </div>\\n                <button class=\\"ghostmonitor-atc-popup-button\\" type=\\"submit\\">{{cta}}</button>\\n              </form>\\n            </div>\\n            <div class=\\"ghostmonitor-atc-popup-close\\"></div>\\n            <div class=\\"recart-messenger-widget\\" data-source=\\"atc_popup\\"></div>\\n            <a class=\\"ghostmonitor-atc-popup-link\\" href=\\"http://recart.com\\" target=\\"_blank\\" style=\\"display: none\\">\\n              Powered by <span class=\\"ghostmonitor-atc-popup-logo\\"></span>\\n            </a>\\n          </div>\\n        </div>\\n      </div>\\n    </div>\\n  </body>\\n</html>\\n";\n// Exports\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (code);\n\n//# sourceURL=webpack://@ghostmonitor/gm-tracking-js/./app/html/templates/atc-modal.html?')},"./node_modules/lodash/_arrayIncludes.js":(module,__unused_webpack_exports,__webpack_require__)=>{eval('var baseIndexOf = __webpack_require__(/*! ./_baseIndexOf */ "./node_modules/lodash/_baseIndexOf.js");\n\n/**\n * A specialized version of `_.includes` for arrays without support for\n * specifying an index to search from.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludes(array, value) {\n  var length = array == null ? 0 : array.length;\n  return !!length && baseIndexOf(array, value, 0) > -1;\n}\n\nmodule.exports = arrayIncludes;\n\n\n//# sourceURL=webpack://@ghostmonitor/gm-tracking-js/./node_modules/lodash/_arrayIncludes.js?')},"./node_modules/lodash/_arrayIncludesWith.js":module=>{eval("/**\n * This function is like `arrayIncludes` except that it accepts a comparator.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @param {Function} comparator The comparator invoked per element.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludesWith(array, value, comparator) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (comparator(value, array[index])) {\n      return true;\n    }\n  }\n  return false;\n}\n\nmodule.exports = arrayIncludesWith;\n\n\n//# sourceURL=webpack://@ghostmonitor/gm-tracking-js/./node_modules/lodash/_arrayIncludesWith.js?")},"./node_modules/lodash/_baseFindIndex.js":module=>{eval("/**\n * The base implementation of `_.findIndex` and `_.findLastIndex` without\n * support for iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Function} predicate The function invoked per iteration.\n * @param {number} fromIndex The index to search from.\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseFindIndex(array, predicate, fromIndex, fromRight) {\n  var length = array.length,\n      index = fromIndex + (fromRight ? 1 : -1);\n\n  while ((fromRight ? index-- : ++index < length)) {\n    if (predicate(array[index], index, array)) {\n      return index;\n    }\n  }\n  return -1;\n}\n\nmodule.exports = baseFindIndex;\n\n\n//# sourceURL=webpack://@ghostmonitor/gm-tracking-js/./node_modules/lodash/_baseFindIndex.js?")},"./node_modules/lodash/_baseIndexOf.js":(module,__unused_webpack_exports,__webpack_require__)=>{eval('var baseFindIndex = __webpack_require__(/*! ./_baseFindIndex */ "./node_modules/lodash/_baseFindIndex.js"),\n    baseIsNaN = __webpack_require__(/*! ./_baseIsNaN */ "./node_modules/lodash/_baseIsNaN.js"),\n    strictIndexOf = __webpack_require__(/*! ./_strictIndexOf */ "./node_modules/lodash/_strictIndexOf.js");\n\n/**\n * The base implementation of `_.indexOf` without `fromIndex` bounds checks.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} value The value to search for.\n * @param {number} fromIndex The index to search from.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseIndexOf(array, value, fromIndex) {\n  return value === value\n    ? strictIndexOf(array, value, fromIndex)\n    : baseFindIndex(array, baseIsNaN, fromIndex);\n}\n\nmodule.exports = baseIndexOf;\n\n\n//# sourceURL=webpack://@ghostmonitor/gm-tracking-js/./node_modules/lodash/_baseIndexOf.js?')},"./node_modules/lodash/_baseIsNaN.js":module=>{eval("/**\n * The base implementation of `_.isNaN` without support for number objects.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is `NaN`, else `false`.\n */\nfunction baseIsNaN(value) {\n  return value !== value;\n}\n\nmodule.exports = baseIsNaN;\n\n\n//# sourceURL=webpack://@ghostmonitor/gm-tracking-js/./node_modules/lodash/_baseIsNaN.js?")},"./node_modules/lodash/_baseUniq.js":(module,__unused_webpack_exports,__webpack_require__)=>{eval('var SetCache = __webpack_require__(/*! ./_SetCache */ "./node_modules/lodash/_SetCache.js"),\n    arrayIncludes = __webpack_require__(/*! ./_arrayIncludes */ "./node_modules/lodash/_arrayIncludes.js"),\n    arrayIncludesWith = __webpack_require__(/*! ./_arrayIncludesWith */ "./node_modules/lodash/_arrayIncludesWith.js"),\n    cacheHas = __webpack_require__(/*! ./_cacheHas */ "./node_modules/lodash/_cacheHas.js"),\n    createSet = __webpack_require__(/*! ./_createSet */ "./node_modules/lodash/_createSet.js"),\n    setToArray = __webpack_require__(/*! ./_setToArray */ "./node_modules/lodash/_setToArray.js");\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * The base implementation of `_.uniqBy` without support for iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new duplicate free array.\n */\nfunction baseUniq(array, iteratee, comparator) {\n  var index = -1,\n      includes = arrayIncludes,\n      length = array.length,\n      isCommon = true,\n      result = [],\n      seen = result;\n\n  if (comparator) {\n    isCommon = false;\n    includes = arrayIncludesWith;\n  }\n  else if (length >= LARGE_ARRAY_SIZE) {\n    var set = iteratee ? null : createSet(array);\n    if (set) {\n      return setToArray(set);\n    }\n    isCommon = false;\n    includes = cacheHas;\n    seen = new SetCache;\n  }\n  else {\n    seen = iteratee ? [] : result;\n  }\n  outer:\n  while (++index < length) {\n    var value = array[index],\n        computed = iteratee ? iteratee(value) : value;\n\n    value = (comparator || value !== 0) ? value : 0;\n    if (isCommon && computed === computed) {\n      var seenIndex = seen.length;\n      while (seenIndex--) {\n        if (seen[seenIndex] === computed) {\n          continue outer;\n        }\n      }\n      if (iteratee) {\n        seen.push(computed);\n      }\n      result.push(value);\n    }\n    else if (!includes(seen, computed, comparator)) {\n      if (seen !== result) {\n        seen.push(computed);\n      }\n      result.push(value);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseUniq;\n\n\n//# sourceURL=webpack://@ghostmonitor/gm-tracking-js/./node_modules/lodash/_baseUniq.js?')},"./node_modules/lodash/_createSet.js":(module,__unused_webpack_exports,__webpack_require__)=>{eval('var Set = __webpack_require__(/*! ./_Set */ "./node_modules/lodash/_Set.js"),\n    noop = __webpack_require__(/*! ./noop */ "./node_modules/lodash/noop.js"),\n    setToArray = __webpack_require__(/*! ./_setToArray */ "./node_modules/lodash/_setToArray.js");\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/**\n * Creates a set object of `values`.\n *\n * @private\n * @param {Array} values The values to add to the set.\n * @returns {Object} Returns the new set.\n */\nvar createSet = !(Set && (1 / setToArray(new Set([,-0]))[1]) == INFINITY) ? noop : function(values) {\n  return new Set(values);\n};\n\nmodule.exports = createSet;\n\n\n//# sourceURL=webpack://@ghostmonitor/gm-tracking-js/./node_modules/lodash/_createSet.js?')},"./node_modules/lodash/_strictIndexOf.js":module=>{eval("/**\n * A specialized version of `_.indexOf` which performs strict equality\n * comparisons of values, i.e. `===`.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} value The value to search for.\n * @param {number} fromIndex The index to search from.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction strictIndexOf(array, value, fromIndex) {\n  var index = fromIndex - 1,\n      length = array.length;\n\n  while (++index < length) {\n    if (array[index] === value) {\n      return index;\n    }\n  }\n  return -1;\n}\n\nmodule.exports = strictIndexOf;\n\n\n//# sourceURL=webpack://@ghostmonitor/gm-tracking-js/./node_modules/lodash/_strictIndexOf.js?")},"./node_modules/lodash/noop.js":module=>{eval("/**\n * This method returns `undefined`.\n *\n * @static\n * @memberOf _\n * @since 2.3.0\n * @category Util\n * @example\n *\n * _.times(2, _.noop);\n * // => [undefined, undefined]\n */\nfunction noop() {\n  // No operation performed.\n}\n\nmodule.exports = noop;\n\n\n//# sourceURL=webpack://@ghostmonitor/gm-tracking-js/./node_modules/lodash/noop.js?")},"./node_modules/lodash/uniq.js":(module,__unused_webpack_exports,__webpack_require__)=>{eval('var baseUniq = __webpack_require__(/*! ./_baseUniq */ "./node_modules/lodash/_baseUniq.js");\n\n/**\n * Creates a duplicate-free version of an array, using\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons, in which only the first occurrence of each element\n * is kept. The order of result values is determined by the order they occur\n * in the array.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {Array} array The array to inspect.\n * @returns {Array} Returns the new duplicate free array.\n * @example\n *\n * _.uniq([2, 1, 2]);\n * // => [2, 1]\n */\nfunction uniq(array) {\n  return (array && array.length) ? baseUniq(array) : [];\n}\n\nmodule.exports = uniq;\n\n\n//# sourceURL=webpack://@ghostmonitor/gm-tracking-js/./node_modules/lodash/uniq.js?')},"./node_modules/observe-element-in-viewport/dist/index.esm.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "isInViewport": () => (/* binding */ r),\n/* harmony export */   "observeElementInViewport": () => (/* binding */ o)\n/* harmony export */ });\nfunction o(o,r,t,e){if(void 0===t&&(t=function(){}),void 0===e&&(e={}),!o)throw new Error("Target element to observe should be a valid DOM Node");var n=Object.assign({},{viewport:null,modTop:"0px",modRight:"0px",modBottom:"0px",modLeft:"0px",threshold:[0]},e),i=n.viewport,a=n.modTop,u=n.modLeft,s=n.modBottom,f=n.modRight,d=n.threshold;if(!Array.isArray(d)&&"number"!=typeof d)throw new Error("threshold should be a number or an array of numbers");var h=Array.isArray(d)?d.map(function(o){return Math.floor(o%101)/100}):[Math.floor(d?d%101:0)/100],c=Math.min.apply(Math,h),m={root:i instanceof Node?i:null,rootMargin:a+" "+f+" "+s+" "+u,threshold:h},l=new IntersectionObserver(function(e,n){var i=e.filter(function(r){return r.target===o})[0],a=function(){return n.unobserve(o)};i&&(i.isInViewport=i.isIntersecting&&i.intersectionRatio>=c,i.isInViewport?r(i,a,o):t(i,a,o))},m);return l.observe(o),function(){return l.unobserve(o)}}var r=function(r,t){return void 0===t&&(t={}),new Promise(function(e,n){try{o(r,function(o,r){r(),e(!0)},function(o,r){r(),e(!1)},t)}catch(o){n(o)}})};\n//# sourceMappingURL=index.esm.js.map\n\n\n//# sourceURL=webpack://@ghostmonitor/gm-tracking-js/./node_modules/observe-element-in-viewport/dist/index.esm.js?')}}]);